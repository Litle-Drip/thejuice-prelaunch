<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TheJuice — Pre‑Launch Bet</title>
  <meta name="description" content="The first ever bet on The Juice… was The Juice itself. No bookie. Just code." />
  <meta name="theme-color" content="#0b1220" />
  <meta property="og:title" content="TheJuice — Pre‑Launch Bet" />
  <meta property="og:description" content="The first ever bet on The Juice… was The Juice itself. No bookie. Just code." />
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <style>
    body {
      background: radial-gradient(1200px 800px at 10% 10%, rgba(0,230,246,.12), transparent 40%),
                  radial-gradient(1000px 700px at 90% 0%, rgba(255,215,0,.08), transparent 45%), #0b1220;
      color: #fff;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    }
    .glass { background: rgba(255,255,255,.05); border: 1px solid rgba(255,255,255,.12); backdrop-filter: blur(10px); box-shadow: 0 10px 30px rgba(0,0,0,.25); }
    .digit { font-variant-numeric: tabular-nums; letter-spacing:.25px; transition: transform .2s ease, color .2s ease; }
    .pulse { transform: scale(1.05); color: #00E6F6; }
    .progress { height:6px; border-radius:9999px; background: rgba(255,255,255,.08); overflow:hidden; position: relative; }
    .progress > span { display:block; height:100%; background: linear-gradient(90deg, rgba(0,230,246,0.3), rgba(0,230,246,0.6), rgba(0,230,246,0.3)); background-size:200% 100%; animation: shimmer 4s infinite linear; }
    @keyframes shimmer { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }
    .selected { outline: 2px solid #00E6F6; outline-offset: 2px; }
    .grid-gap { gap: 1.25rem; }
  </style>
</head>
<body class="min-h-screen">
  <main class="max-w-5xl mx-auto px-6 py-12 space-y-12">
    <header class="text-center space-y-3">
      <h1 class="text-4xl font-bold tracking-tight">TheJuice — Pre‑Launch Bet</h1>
      <p class="text-cyan-400 text-sm">The first ever bet on The Juice… was The Juice itself</p>
    </header>

    <section class="glass rounded-2xl p-8 space-y-10">
      <div class="text-center space-y-3">
        <h2 class="text-3xl font-semibold">Will The Juice launch before <span id="deadlineLabel"></span>?</h2>
        <p class="text-slate-300">No bookie. Just code. (Pre‑launch demo — real escrow + wallets go live at launch.)</p>
      </div>

      <div id="countdown" class="grid grid-cols-2 md:grid-cols-4 gap-4 justify-center">
        <div class="glass rounded-xl p-4 text-center"><div id="d" class="digit text-5xl font-bold">—</div><div class="text-xs text-slate-300">Days</div></div>
        <div class="glass rounded-xl p-4 text-center"><div id="h" class="digit text-5xl font-bold">—</div><div class="text-xs text-slate-300">Hours</div></div>
        <div class="glass rounded-xl p-4 text-center"><div id="m" class="digit text-5xl font-bold">—</div><div class="text-xs text-slate-300">Minutes</div></div>
        <div class="glass rounded-xl p-4 text-center"><div id="s" class="digit text-5xl font-bold">—</div><div class="text-xs text-slate-300">Seconds</div></div>
      </div>

      <div class="grid md:grid-cols-2 grid-gap">
        <button id="btnBefore" class="rounded-xl p-4 text-left bg-green-400/10 border border-green-300/20 hover:bg-green-400/20">
          <div class="flex justify-between items-center">
            <div>
              <div class="text-green-300 font-medium">Before deadline</div>
              <div class="text-slate-400 text-sm">I believe we ship before the countdown ends.</div>
            </div>
            <div class="text-right">
              <div id="beforePct" class="text-lg font-semibold">0%</div>
              <div id="beforeVotes" class="text-xs text-slate-400">0 votes</div>
            </div>
          </div>
          <div class="progress mt-3"><span id="beforeBar" style="width:0%"></span></div>
        </button>
        <button id="btnAfter" class="rounded-xl p-4 text-left bg-red-400/10 border border-red-300/20 hover:bg-red-400/20">
          <div class="flex justify-between items-center">
            <div>
              <div class="text-red-300 font-medium">After deadline</div>
              <div class="text-slate-400 text-sm">We think it slips past the countdown.</div>
            </div>
            <div class="text-right">
              <div id="afterPct" class="text-lg font-semibold">0%</div>
              <div id="afterVotes" class="text-xs text-slate-400">0 votes</div>
            </div>
          </div>
          <div class="progress mt-3"><span id="afterBar" style="width:0%"></span></div>
        </button>
      </div>

      <div class="grid md:grid-cols-3 grid-gap">
        <div class="glass rounded-xl p-3 text-center"><div class="text-xs text-slate-300">Your vote</div><div id="yourVote" class="text-sm font-medium">—</div></div>
        <div class="glass rounded-xl p-3 md:col-span-2 text-center"><div class="text-xs text-slate-300">Totals</div><div id="totals" class="text-sm font-medium">0 : 0</div></div>
      </div>

      <form id="emailForm" class="max-w-md mx-auto space-y-2">
        <div class="flex gap-2">
          <input id="emailInput" type="email" placeholder="Enter email for early access" class="input flex-1 rounded-lg px-3 py-2 text-sm placeholder:text-slate-400 text-white focus:outline-none" required>
          <button id="notifyBtn" class="btn rounded-lg px-4 py-2 bg-cyan-500/80 hover:bg-cyan-500 text-white" type="submit">Notify me</button>
        </div>
        <p id="emailMsg" class="text-xs text-slate-400"></p>
      </form>

      <div class="flex items-center justify-center gap-3">
        <button id="copyLink" class="btn rounded-lg px-3 py-2 bg-white/10 border border-white/20 hover:bg-white/15">Copy page link</button>
        <span id="copyToast" class="text-xs text-emerald-300 opacity-0 transition-opacity">Copied ✓</span>
        <canvas id="qr" width="96" height="96" class="rounded-lg border border-white/20 bg-white/5"></canvas>
      </div>

      <p class="text-slate-400 text-xs text-center">Pre‑launch demo: votes are visual only. On launch, bets will be on‑chain (Base) with trustless escrow and a protocol fee (min 2.5%).</p>
    </section>
  </main>

  <script>
    const LAUNCH_UTC = '2025-12-31T23:59:59Z';

    function parseDeadline(s){ return new Date(s); }

    function startCountdown(deadline){
      const ids = ['d','h','m','s'];
      function update(){
        const now = new Date(); let diff = Math.max(0, deadline-now);
        const d = Math.floor(diff/86400000); diff-=d*86400000;
        const h = Math.floor(diff/3600000); diff-=h*3600000;
        const m = Math.floor(diff/60000); diff-=m*60000;
        const s = Math.floor(diff/1000);
        [d,h,m,s].forEach((v,i)=>document.getElementById(ids[i]).textContent=v);
      }
      update();
      let ticks=0;
      setInterval(()=>{ update(); ticks++; if(ticks%10===0){ document.querySelectorAll('.digit').forEach(el=>{ el.classList.add('pulse'); setTimeout(()=>el.classList.remove('pulse'),300); }); } },1000);
    }

    function drawQR(text, size, canvas){
      if(!canvas) return;
      const srcs=[
        `https://chart.googleapis.com/chart?cht=qr&chs=${size}x${size}&chl=${encodeURIComponent(text)}`,
        `https://api.qrserver.com/v1/create-qr-code/?size=${size}x${size}&data=${encodeURIComponent(text)}`,
        `https://quickchart.io/qr?size=${size}&text=${encodeURIComponent(text)}`
      ];
      const ctx=canvas.getContext('2d');
      let i=0, t; const img=new Image(); img.crossOrigin='anonymous';
      img.onload=()=>{ clearTimeout(t); ctx.clearRect(0,0,size,size); ctx.drawImage(img,0,0,size,size); };
      img.onerror=()=>{ if(i<srcs.length-1){ i++; load(); } };
      function load(){ img.src=srcs[i]; t=setTimeout(()=>img.onerror(), 2500); }
      load();
    }

    function confettiLaunch(){ confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 } }); }

    const STORE_KEY='tj_prelaunch_votes_v2';
    function getData(){ try{ return JSON.parse(localStorage.getItem(STORE_KEY))||{totals:{before:0,after:0},user:{vote:null}};}catch{return {totals:{before:0,after:0},user:{vote:null}};} }
    function setData(d){ localStorage.setItem(STORE_KEY, JSON.stringify(d)); }

    function render(d){
      const a=d.totals.before||0,b=d.totals.after||0,sum=(a+b)||1;
      const bp=a/sum,ap=b/sum;
      document.getElementById('beforePct').textContent=(bp*100).toFixed(1)+'%';
      document.getElementById('afterPct').textContent=(ap*100).toFixed(1)+'%';
      document.getElementById('beforeVotes').textContent=a+' vote'+(a!==1?'s':'');
      document.getElementById('afterVotes').textContent=b+' vote'+(b!==1?'s':'');
      document.getElementById('beforeBar').style.width=(bp*100)+'%';
      document.getElementById('afterBar').style.width=(ap*100)+'%';
      document.getElementById('totals').textContent=`${a} : ${b}`;
      document.getElementById('yourVote').textContent=d.user.vote?d.user.vote.charAt(0).toUpperCase()+d.user.vote.slice(1):'—';
    }

    function vote(side){
      const d=getData();
      if(!['before','after'].includes(side))return;
      const firstVote=!d.user.vote;
      if(d.user.vote===side){render(d);return;}
      if(d.user.vote)d.totals[d.user.vote]=Math.max(0,(d.totals[d.user.vote]||0)-1);
      d.user.vote=side; d.totals[side]=(d.totals[side]||0)+1; setData(d); render(d);
      if(firstVote) confettiLaunch();
    }

    document.addEventListener('DOMContentLoaded',()=>{
      const deadline=parseDeadline(LAUNCH_UTC);
      document.getElementById('deadlineLabel').textContent=deadline.toLocaleDateString(undefined,{year:'numeric',month:'short',day:'numeric'});
      startCountdown(deadline);
      document.getElementById('btnBefore').onclick=()=>vote('before');
      document.getElementById('btnAfter').onclick=()=>vote('after');
      render(getData());
      // draw QR of current page
      drawQR(location.href, 96, document.getElementById('qr'));
    });
  </script>
</body>
</html>
